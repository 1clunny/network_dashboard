{% extends "layout.html" %}
{% block content %}

<div class="flex flex-col md:flex-row gap-6 min-h-[60vh] md:min-h-[calc(100vh-4rem)] items-stretch">
  <!-- Device Status Graph -->
  <div class="flex-1 bg-gray-900/60 backdrop-blur-xl rounded-2xl border border-gray-800 p-6 relative overflow-hidden">
    <h2 class="text-lg font-semibold text-accent mb-4">Device Status Graph</h2>
    <div id="statusGrid" class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4"></div>
  </div>

  <!-- Device List -->
  <div class="bg-gray-900/70 backdrop-blur-xl rounded-2xl border border-gray-800 p-6">
    <h2 class="text-lg font-semibold text-accent mb-4">Device Overview</h2>
    <div id="deviceList" class="grid grid-cols-2 md:grid-cols-4 gap-4 text-gray-300">
      <!-- Device buttons will go here -->
    </div>
  </div>

  <!-- Sidebar Info -->
  <div class="w-full md:w-80 bg-gray-900/70 backdrop-blur-xl rounded-2xl border border-gray-800 p-6 self-stretch h-full">
    <h3 class="text-accent font-semibold mb-4">Device Info</h3>
    <div id="deviceInfo" class="text-gray-400 space-y-2">
      <p>Select a device from the columns or from the list ðŸ‘‡</p>
    </div>
  </div>
</div>

<script>
const infoBox = document.getElementById("deviceInfo");
const deviceListContainer = document.getElementById("deviceList");

// Devices with status
const devices = [
  { name: "Router", status: "connected", ip: "192.168.1.1", color: "#00C6FF" },
  { name: "Laptop", status: "connected", ip: "192.168.1.23", color: "#22c55e" },
  { name: "Phone", status: "idle", ip: "192.168.1.45", color: "#facc15" },
  { name: "Camera", status: "off", ip: "192.168.1.55", color: "#ef4444" },
];

function showDevice(d) {
  infoBox.innerHTML = `
    <p class="text-sm text-gray-400">Status: <span class="font-semibold text-white">${d.status}</span></p>
    <h4 class="text-white font-semibold mt-2">${d.name}</h4>
    <p class="text-gray-400">${d.ip}</p>
  `;
}

function buildStatusGrid() {
  const container = document.getElementById('statusGrid');
  container.innerHTML = '';
  const statuses = ["connected", "idle", "off"];
  statuses.forEach(s => {
    const col = document.createElement('div');
    col.className = 'bg-gray-900/30 p-4 rounded-lg min-h-[160px] flex flex-col';
    col.innerHTML = `<h3 class="text-sm font-semibold text-accent capitalize">${s}</h3><div class="devices mt-3 flex flex-col gap-2"></div>`;
    const list = col.querySelector('.devices');
    devices.filter(d => d.status === s).forEach(d => {
      const btn = document.createElement('button');
      btn.className = 'flex items-center gap-3 p-2 bg-gray-800/50 hover:bg-gray-800 rounded-lg';
      btn.innerHTML = `<span class="w-3 h-3 rounded-full" style="background:${d.color}"></span><span class="text-sm">${d.name}</span>`;
      btn.addEventListener('click', () => showDevice(d));
      list.appendChild(btn);
    });
    container.appendChild(col);
  });
}

function buildDeviceList() {
  deviceListContainer.innerHTML = '';
  devices.forEach(d => {
    const btn = document.createElement('button');
    btn.className = 'bg-gray-800 hover:bg-gray-700 rounded-lg p-2 text-left cursor-pointer transition-colors';
    btn.innerHTML = `<span class="font-semibold">${d.name}</span><br><span class="text-sm text-gray-400">${d.ip}</span>`;
    btn.addEventListener('click', () => showDevice(d));
    deviceListContainer.appendChild(btn);
  });
}

buildStatusGrid();
buildDeviceList();
</script>

{% endblock %}